--// GUI
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local Toggle = Instance.new("TextButton")

ScreenGui.Parent = game:GetService("CoreGui")
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

Frame.Parent = ScreenGui
Frame.BackgroundColor3 = Color3.fromRGB(255, 182, 193)
Frame.Size = UDim2.new(0, 150, 0, 50)
Frame.Position = UDim2.new(0, 100, 0, 200)

Toggle.Parent = Frame
Toggle.BackgroundColor3 = Color3.fromRGB(255, 105, 180)
Toggle.Size = UDim2.new(1, 0, 1, 0)
Toggle.Text = "Toggle Fly"
Toggle.TextScaled = true
Toggle.TextColor3 = Color3.fromRGB(255,255,255)

--// Fly Script
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hum = char:WaitForChild("Humanoid")
local hrp = char:WaitForChild("HumanoidRootPart")

local flying = false
local flySpeed = 60
local bv, bg

-- Fungsi mulai fly
local function startFly()
	flying = true
	hum.PlatformStand = true
	
	bv = Instance.new("BodyVelocity")
	bv.MaxForce = Vector3.new(1e5,1e5,1e5)
	bv.Velocity = Vector3.zero
	bv.Parent = hrp
	
	bg = Instance.new("BodyGyro")
	bg.MaxTorque = Vector3.new(1e5,1e5,1e5)
	bg.CFrame = hrp.CFrame
	bg.P = 9e4
	bg.Parent = hrp
	
	-- loop gerak
	while flying and task.wait() do
		local cam = workspace.CurrentCamera
		local moveDir = hum.MoveDirection
		
		-- ambil basis kamera
		local forward = cam.CFrame.LookVector
		local right = cam.CFrame.RightVector
		
		-- proyeksi arah input joystick ke basis kamera
		local dir = (forward * moveDir.Z) + (right * moveDir.X)
		
		-- set velocity
		bv.Velocity = dir * flySpeed
		
		-- rotasi ikut kamera
		bg.CFrame = CFrame.new(hrp.Position, hrp.Position + forward)
	end
end

-- Fungsi stop fly
local function stopFly()
	flying = false
	hum.PlatformStand = false
	if bv then bv:Destroy() end
	if bg then bg:Destroy() end
end

-- Toggle button
Toggle.MouseButton1Click:Connect(function()
	if flying then
		stopFly()
		Toggle.Text = "Toggle Fly"
	else
		startFly()
		Toggle.Text = "Stop Fly"
	end
end)